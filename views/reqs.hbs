<!DOCTYPE html>
<html>
<head>
    <link href="/css/class.css" rel="stylesheet">
    <link href="/css/schedule.css" rel="stylesheet">
  <title>Requirements | {{coursecode}}</title>
  <script src = "https://code.jquery.com/jquery-3.4.1.min.js" type = "text/javascript">
  </script>

  <style>
    h6
    {
      margin:  5px;
      text-indent: 20px;
      text-align: justify;
    }

    #origCommentDiv, .createcontainer, .editcontainer,
    #main_edit_container, #main_CreateDiv
    {
      display: none;
    }
  </style>
</head>
<body>
  {{>topnav}}
    <div id = "content">
      <nav id = "sideNav">
        <div class="navigationDiv">
          <ul class="navbar-nav" style="margin-top: 20px; background-color: white">
                <li class="nav-item item">
                    <a class="nav-link icon_name" href="/classes/{{classID}}/home"><i class="fa fa-home icon"></i> Home </a>
                </li>
                <li class="nav-item item">
                    <a class="nav-link icon_name" href="/classes/{{classID}}/classlist"><i class="far fa-address-book icon"></i> Class List</a>
                </li>
                <li class="nav-item item up">
                    <a class="nav-link icon_name" href="/classes/{{classID}}/discussions"><i class="far fa-clone icon"></i> Discussions</a>
                </li>
                <li class="nav-item item">
                  <div class="active" style="background-color: white">
                    <a class="nav-link" href="/classes/{{classID}}/requirements" style="color: #5161ce; padding-left: 10px"><i class="far fa-calendar-alt"></i> Requirements</a>
                  </div>
                </li>
                <li class="nav-item item down">
                    <a class="nav-link icon_name" href="/classes/{{classID}}/notebook"><i class="fa fa-pencil-square-o icon"></i> Notebook</a>
                </li>
            </ul>
        </div>
      </nav>
      <div class="main">
        <ul class="breadcrumb">
          <li><a href="/home">blueprint</a></li>
          <li><a href="/classes/dashboard">Classes</a></li>
          <li><a href="/classes/{{classID}}/home">{{coursecode}}</a></li>
          <li>Requirements</li>
        </ul> 
        <h1>Requirements</h1>
        <h5>Don't forget to do your tasks!</h5>
        <a href ="/classes/{{classID}}/requirements/add" title="Add a new requirement">
          <i class="fa fa-plus" style="font-size: 25px; margin-top: -3%; float: right; color: #457B9D"></i>
        </a>
        <hr>
        
        {{#each result}}
        <div class="req-list" 
             name = "/classes/{{../classID}}/requirements/{{reqID}}/edit">
          <div class="task-container" id = "{{reqID}}">
            <h3 id="{{reqID}}req-title" class = "req-title">{{title}}</h3>
            <h6 id="{{reqID}}req-type" class = "req-type">{{typeOfReq}} | Due {{deadline}}</h6><hr>
            <h6 id="{{reqID}}req-details" class = "req-details">{{desc}}</h6>
            <div style="display: flex; flex-direction: row; margin-top: 0px; margin-bottom: 0px; width: max-content; margin: auto 0 auto auto">
              <button class="btn edt_btn" id = "ebtn_{{reqID}}">
                <i class="fa fa-pencil disc_icon" title="Edit requirement"></i>
              </button>
              <form action = "/classes/{{classID}}/requirements/{{reqID}}/delete" 
                    method = "post">
                <button class = "btn" title = "Delete discussion">
                  <i class="fas fa-eraser disc_icon"></i>
                </button>
              </form>
            </div>   
          </div>
        </div>
          {{else}}
              <h3 style="text-align: center; padding: 40px">There are no requirements yet.</h3> 
          {{/each}} 

          <div class = "editcontainer">
            <form class = "form" style = "width: 100%; height: 80%;" method = "post">
                <div class = "container input-group mb-3">
                  <label for="type" class="input_field">Type</label>
                    <input type = "text" name = "type" id = "type" class = "form-control input_user" value = "" style="border-radius: 0px; color: black">
                </div>
                <div class = "container input-group mb-3">
                  <label for="deadline" class="input_field">Deadline</label>
                    <input type = "datetime-local" name = "deadline" id = "deadline" class = "form-control input_user" value = "" style="border-radius: 0px; color: black">
                </div>
                <div class = "container input-group mb-3">
                  <label for="paragraph_text" class="input_field">Description</label>
                  <textarea name="paragraph_text" cols="97" rows="10" id = "desc_txt">
                  </textarea>
                </div>
                <div class = "display" style = "padding: 0 40px; margin-top: 10px;">
                  <button type = "submit" name = "edit_button" id="edit_button" class = "btn">Edit!
                  </button>
               </div>
            </form>
          </div> 

      </div>
    </div>

    <script type="text/javascript">
        $(document).ready (function () {
          $(".edt_btn").click (function ()
          {
            var btn_id = $(this).attr ("id");
            var reqID = btn_id.substring (5, btn_id.length);
            
            $(".editcontainer").css ("display", "block");

            $(".form").attr ("action", $(this).closest (".req-list").attr ("name"));
            var temp = $("#" + reqID + "req-type").html ();
            temp = temp.split ("|");
            var type = temp  [0];
            
            $("#type").val (type);
            $("#desc_txt").val ($("#" + reqID + "req-details").html ());
          });

        });
    </script>
</body>
</html>
